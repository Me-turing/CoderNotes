import{_ as n}from"./plugin-vue_export-helper-c27b6911.js";import{o as s,c as a,f as e}from"./app-71f45f98.js";const t="/CoderNotes/assets/image-20230707100856563-196dc65e.png",p="/CoderNotes/assets/image-20230707100812881-4a57ee79.png",l={},o=e(`<p>Druid是由阿里巴巴推出的数据库连接池。它结合了C3P0、DBCP、PROXOOL等数据库连接池的优点。之所以从众多数据库连接池中脱颖而出，还有一个重要的原因就是它包含控制台,很方便的帮助我们实现对于sql执行的监控。</p><h2 id="添加依赖" tabindex="-1"><a class="header-anchor" href="#添加依赖" aria-hidden="true">#</a> 添加依赖</h2><p>我们需要在SpringBoot中添加druid的启动器依赖</p><div class="language-XML line-numbers-mode" data-ext="XML"><pre class="language-XML"><code>&lt;!--druid连接池--&gt;
&lt;dependency&gt;
	&lt;groupId&gt;com.alibaba&lt;/groupId&gt;
	&lt;artifactId&gt;druid-spring-boot-starter&lt;/artifactId&gt;
	&lt;version&gt;1.1.10&lt;/version&gt;
&lt;/dependency&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>注意 : 我们此处导入的是启动器依赖,在之前的使用中导入的是单个连接池的依赖,这两个是有区别的</p></blockquote><h2 id="修改配置" tabindex="-1"><a class="header-anchor" href="#修改配置" aria-hidden="true">#</a> 修改配置</h2><p>修改application.yml文件,添加druid的相关配置</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//xxx.xxx.xxx.xx<span class="token punctuation">:</span>3306/codernotes<span class="token punctuation">?</span>useSSL=false<span class="token important">&amp;useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=Asia/Shanghai</span>
    <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.cj.jdbc.Driver
    <span class="token key atrule">username</span><span class="token punctuation">:</span> CoderNotes
    <span class="token key atrule">password</span><span class="token punctuation">:</span> CoderNotes
    <span class="token key atrule">type</span><span class="token punctuation">:</span> com.alibaba.druid.pool.DruidDataSource <span class="token comment"># 使用阿里的Druid连接池</span>
    <span class="token key atrule">druid</span><span class="token punctuation">:</span> <span class="token comment"># 连接池的配置信息</span>
      <span class="token key atrule">initial-size</span><span class="token punctuation">:</span> <span class="token number">5</span> <span class="token comment"># 初始化连接数量</span>
      <span class="token key atrule">min-idle</span><span class="token punctuation">:</span> <span class="token number">5</span> <span class="token comment"># 最小空闲数量</span>
      <span class="token key atrule">max-active</span><span class="token punctuation">:</span> <span class="token number">20</span> <span class="token comment"># 最大链接数</span>
      <span class="token key atrule">max-wait</span><span class="token punctuation">:</span> <span class="token number">60000</span> <span class="token comment"># 配置获取连接等待超时的时间,单位是毫秒</span>
      <span class="token key atrule">time-between-eviction-runs-millis</span><span class="token punctuation">:</span> <span class="token number">60000</span> <span class="token comment"># 配置间隔多久才进行一次检测，检测需要关闭的空闲连接，单位是毫秒</span>
      <span class="token key atrule">min-evictable-idle-time-millis</span><span class="token punctuation">:</span> <span class="token number">30000</span> <span class="token comment"># 配置一个连接在池中最小生存的时间，单位是毫秒</span>
      <span class="token key atrule">validationQuery</span><span class="token punctuation">:</span> SELECT 1 <span class="token comment"># 验证查询</span>
      <span class="token key atrule">testWhileIdle</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment"># 空闲时测试</span>
      <span class="token key atrule">testOnBorrow</span><span class="token punctuation">:</span> <span class="token boolean important">false</span> <span class="token comment"># 借用测试</span>
      <span class="token key atrule">testOnReturn</span><span class="token punctuation">:</span> <span class="token boolean important">false</span> <span class="token comment"># 返回时测试</span>
      <span class="token key atrule">poolPreparedStatements</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment"># 打开PSCache，并且指定每个连接上PSCache的大小</span>
      <span class="token key atrule">maxPoolPreparedStatementPerConnectionSize</span><span class="token punctuation">:</span> <span class="token number">20</span>
      <span class="token key atrule">filters</span><span class="token punctuation">:</span> stat<span class="token punctuation">,</span>wall<span class="token punctuation">,</span>slf4j <span class="token comment"># 配置监控统计拦截的filters，去掉后监控界面sql无法统计，&#39;wall&#39;用于防火墙</span>
      <span class="token key atrule">connectionProperties</span><span class="token punctuation">:</span> druid.stat.mergeSql\\=true;druid.stat.slowSqlMillis\\=5000 <span class="token comment"># 通过connectProperties属性来打开mergeSql功能；慢SQL记录</span>
      <span class="token key atrule">web-stat-filter</span><span class="token punctuation">:</span> <span class="token comment"># 配置DruidStatFilter</span>
        <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">url-pattern</span><span class="token punctuation">:</span> <span class="token string">&quot;/*&quot;</span>
        <span class="token key atrule">exclusions</span><span class="token punctuation">:</span> <span class="token string">&quot;*.js,*.gif,*.jpg,*.bmp,*.png,*.css,*.ico,/druid/*&quot;</span>
      <span class="token key atrule">stat-view-servlet</span><span class="token punctuation">:</span> <span class="token comment"># 配置DruidStatViewServlet</span>
        <span class="token key atrule">url-pattern</span><span class="token punctuation">:</span> <span class="token string">&quot;/druid/*&quot;</span>
        <span class="token key atrule">allow</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">,</span>192.168.8.109 <span class="token comment"># IP白名单(没有配置或者为空，则允许所有访问)</span>
        <span class="token key atrule">deny</span><span class="token punctuation">:</span> 192.168.1.188 <span class="token comment"># IP黑名单 (存在共同时，deny优先于allow)</span>
        <span class="token key atrule">reset-enable</span><span class="token punctuation">:</span> <span class="token boolean important">false</span> <span class="token comment">#  禁用控制台页面上的“重置”功能</span>
        <span class="token key atrule">login-username</span><span class="token punctuation">:</span> admin <span class="token comment"># 登录名</span>
        <span class="token key atrule">login-password</span><span class="token punctuation">:</span> <span class="token number">123456</span> <span class="token comment"># 登录密码</span>
<span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8081</span>
  <span class="token key atrule">servlet</span><span class="token punctuation">:</span>
    <span class="token key atrule">context-path</span><span class="token punctuation">:</span> /springboot03
<span class="token key atrule">mybatis</span><span class="token punctuation">:</span>
  <span class="token key atrule">type-aliases-package</span><span class="token punctuation">:</span> com.meturing.pojo <span class="token comment">#指定pojo的位置</span>
  <span class="token key atrule">mapper-locations</span><span class="token punctuation">:</span> classpath<span class="token punctuation">:</span>mapper/<span class="token important">*.xml</span>  <span class="token comment">#如果没有将Mapper与接口放到一起,可以使用该参数指定Mapper的位置</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="启动测试" tabindex="-1"><a class="header-anchor" href="#启动测试" aria-hidden="true">#</a> 启动测试</h2><p>打开<code>http://localhost:8081/springboot03/druid/login.html</code>页面,输入账号密码(配置文件中配置的)<br><img src="`+t+'" alt="" loading="lazy"></p><p>查看控制台<br><img src="'+p+'" alt="" loading="lazy"></p>',11),c=[o];function i(u,r){return s(),a("div",null,c)}const m=n(l,[["render",i],["__file","SpringBoot整合Druid.html.vue"]]);export{m as default};
